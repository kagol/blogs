import{_ as a,B as n,o as l,c as p,G as o,Q as e}from"./chunks/framework.1fee3549.js";const A=JSON.parse('{"title":"用积木理论设计一个灵活好用的 Carousel 走马灯组件","description":"","frontmatter":{},"headers":[],"relativePath":"tech/2022/building-block-theory-develop-carousel.md","filePath":"tech/2022/building-block-theory-develop-carousel.md"}'),t={name:"tech/2022/building-block-theory-develop-carousel.md"},c=e(`<h1 id="用积木理论设计一个灵活好用的-carousel-走马灯组件" tabindex="-1">用积木理论设计一个灵活好用的 Carousel 走马灯组件 <a class="header-anchor" href="#用积木理论设计一个灵活好用的-carousel-走马灯组件" aria-label="Permalink to &quot;用积木理论设计一个灵活好用的 Carousel 走马灯组件&quot;">​</a></h1><p>之前写了一篇<a href="https://juejin.cn/post/7047503485054484516" target="_blank" rel="noreferrer">前端开发的积木理论</a>，给大家分享了我的组件设计价值观，有小伙伴评论：</p><blockquote><p>看完了，好像感觉又没看</p></blockquote><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e59086ccf6d46acbe14268aae8d95a3~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p>主要是那篇文章比较偏理论，列举的案例也太简单，因此决定写一篇实战类的文章。</p><p>接下来我以<code>Carousel</code>走马灯组件的设计和开发为例，给大家分享如何实践积木理论。</p><p><a href="https://juejin.cn/post/7047503485054484516" target="_blank" rel="noreferrer">积木理论</a>有几个关键思想，其中<code>抽象</code>和<code>分层</code>是最核心的思想。</p><h2 id="_1-抽象出-carousel-组件的核心" tabindex="-1">1 抽象出 Carousel 组件的核心 <a class="header-anchor" href="#_1-抽象出-carousel-组件的核心" aria-label="Permalink to &quot;1 抽象出 Carousel 组件的核心&quot;">​</a></h2><p>开发Carousel组件之前，我们先随便找一个涉及该组件的场景，比如<a href="https://juejin.cn/events" target="_blank" rel="noreferrer">掘金活动</a>页面里的这个：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e9c8966a1624ebba75ab9e46567c394~tplv-k3u1fbpfcp-watermark.image?" alt="掘金走马灯.png"></p><p>先分析下这个组件的<code>组成部分</code>和<code>核心交互</code>。</p><p>比较直观能感知到的就是组件的<code>组成部分</code>，<code>Carousel</code>组件主要有以下三个组成部分：</p><ul><li>核心的<code>内容区域</code></li><li>中下区域的<code>分页指示器</code></li><li>左右的<code>分页按钮</code></li></ul><p><code>Carousel</code>组件的核心交互其实是一个分页功能，不管是点击分页指示器中的小圆点还是点击左右分页按钮，都是对当前内容进行切换（即分页）。</p><p>而分页功能的核心包含两部分：</p><ul><li>当前页码</li><li>切换页码的动作</li></ul><h2 id="_2-实现carousel组件的核心分页功能" tabindex="-1">2 实现Carousel组件的核心分页功能 <a class="header-anchor" href="#_2-实现carousel组件的核心分页功能" aria-label="Permalink to &quot;2 实现Carousel组件的核心分页功能&quot;">​</a></h2><p>将组件的核心分析清楚之后，我们先不着急画界面，先实现其中最核心的分页功能，这部分是UI无关的，也是框架无关的，我们选择用<code>Vue3</code>的<a href="https://v3.cn.vuejs.org/guide/composition-api-introduction.html" target="_blank" rel="noreferrer">Composition API</a>来实现。</p><p>在之前跟村长老师的直播中，我们已经手把手教大家从0搭建一个组件库，这里捡其中关键的几个步骤，详细的可以去看之前的文章和视频。</p><ol><li>初始化一个工程<code>Vite</code>+<code>Vue3</code>+<code>TypeScript</code>：<code>yarn create vite mini-vue-devui --template=vue-ts</code></li><li>引入<code>jsx</code>并在<code>vite.config.ts</code>中配置：<code>yarn add -D @vitejs/plugin-vue-jsx</code></li><li>安装<code>sass</code>：<code>yarn add -D sass</code></li></ol><p>以上三个步骤就能初始化一个我们需要的vue工程环境，这时我们可以设计好目录结构，完全按照<a href="https://github.com/DevCloudFE/vue-devui" target="_blank" rel="noreferrer">Vue DevUI</a>开源组件库的规范来。</p><p>在<code>src/components</code>下创建组件目录<code>carousel</code>，并按照以下目录结构组织文件：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">carousel</span></span>
<span class="line"><span style="color:#babed8;">├── __tests__ ## 单元测试</span></span>
<span class="line"><span style="color:#babed8;">|  └── carousel.spec.ts</span></span>
<span class="line"><span style="color:#babed8;">├── index.ts ## 组件入口文件</span></span>
<span class="line"><span style="color:#babed8;">└── src ## 组件源码</span></span>
<span class="line"><span style="color:#babed8;">   ├── carousel.scss ## 组件样式</span></span>
<span class="line"><span style="color:#babed8;">   ├── carousel.tsx ## vue组件</span></span>
<span class="line"><span style="color:#babed8;">   └── composables ## 组件逻辑（Composition API）</span></span>
<span class="line"><span style="color:#babed8;">      └── use-page.ts</span></span></code></pre></div><p>我们聚焦在<code>use-page.ts</code>，这是一个<code>Composition API</code>，用于实现<code>Carousel</code>组件的分页功能。</p><p>这个文件应该导出一个<code>usePage</code>的方法，方法里面导出：</p><ul><li>当前页码<code>pageIndex</code></li><li>一些分页的工具方法，比如上一页<code>prevPage</code>、下一页<code>nextPage</code>等</li></ul><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">ref</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vue</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">usePage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">defaultPageIndex</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 当前页码</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">pageIndex</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">ref</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">defaultPageIndex</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 跳到第几页</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">setPageIndex</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">current</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">pageIndex</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">current</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 一次性往前（或往后）跳几页</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">jumpPage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">page</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">pageIndex</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">page</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 上一页</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">prevPage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">jumpPage</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 下一页</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">nextPage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">jumpPage</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">pageIndex</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">setPageIndex</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">jumpPage</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">prevPage</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">nextPage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>看着是不是特别简单，这其实就是<code>Carousel</code>/<code>Pagination</code>等分页类组件最核心的部分。</p><p>我们来用用看。</p><p>我们在<code>carousel.tsx</code>中引入并使用刚刚创建的<code>usePage</code>。</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">import { defineComponent } from &#39;vue&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import usePage from &#39;./composables/use-page&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">export default defineComponent({</span></span>
<span class="line"><span style="color:#BABED8;">  name: &#39;DCarousel&#39;,</span></span>
<span class="line"><span style="color:#BABED8;">  setup() {</span></span>
<span class="line"><span style="color:#BABED8;">    const { pageIndex, prevPage, nextPage } = usePage(1)</span></span>
<span class="line"><span style="color:#BABED8;">    return () =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">      return </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devui-carousel</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        &lt;button onClick={ prevPage }&gt;上一页&lt;/button&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        &lt;span&gt;当前页码：{ pageIndex.value }&lt;/span&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        &lt;button onClick={ nextPage }&gt;下一页&lt;/button&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">})</span></span></code></pre></div><p>接下来我们在<code>App.vue</code>中使用<code>Carousel</code>组件：</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">setup</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">lang</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">DCarousel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./components/carousel</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">img</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">alt</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Vue logo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./assets/logo.png</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>效果如下：</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a6b0703a0954081b4bf305df84dd902~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.34.58.gif"></p><h2 id="_3-将分页功能与ui结合" tabindex="-1">3 将分页功能与UI结合 <a class="header-anchor" href="#_3-将分页功能与ui结合" aria-label="Permalink to &quot;3 将分页功能与UI结合&quot;">​</a></h2><p>前面实现的<code>usePage</code>是与UI无关的分页功能，可以用在任何分页的场景中，我们一起来看看怎么把它与Carousel组件结合起来，实现基础的轮播功能吧。</p><p>轮播图大致的实现原理是：</p><ul><li>将每一页的内容排在一起</li><li>然后通过控制内容在轮播容器中的位置来实现只展示当前内容</li></ul><p>先在<code>carousel.tsx</code>中增加一个容器元素<code>carousel-item-container</code>，用于包裹传入的内容。</p><p>然后将默认插槽内容放在容器里面。</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">import { defineComponent, renderSlot, useSlots } from &#39;vue&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import usePage from &#39;./composables/use-page&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import &#39;./carousel.scss&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">export default defineComponent({</span></span>
<span class="line"><span style="color:#BABED8;">  name: &#39;DCarousel&#39;,</span></span>
<span class="line"><span style="color:#BABED8;">  setup() {</span></span>
<span class="line"><span style="color:#BABED8;">    const { pageIndex, prevPage, nextPage } = usePage(1)</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    // 获取插槽内容中的元素数量</span></span>
<span class="line"><span style="color:#BABED8;">    const count = useSlots().default().length</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    return () =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">      return </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devui-carousel</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        // 新增容器元素</span></span>
<span class="line"><span style="color:#BABED8;">        &lt;div class=&quot;devui-carousel-item-container&quot; style={{</span></span>
<span class="line"><span style="color:#BABED8;">          width: count * 100 + &#39;%&#39;, // 根据内容元素的数量计算容器宽度</span></span>
<span class="line"><span style="color:#BABED8;">          left: - (pageIndex.value - 1) * 100 + &#39;%&#39;, // 根据当前页码计算容器偏移的位置，从而显示特定的元素内容</span></span>
<span class="line"><span style="color:#BABED8;">        }}&gt;{renderSlot(useSlots(), &#39;default&#39;)}</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        </span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">onClick</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">{</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">prevPage</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">}</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">上一页</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">当前页码：{ pageIndex.value }</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">span</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">onClick</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">{</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">nextPage</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">}</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">下一页</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">})</span></span></code></pre></div><p>接着在<code>carousel.scss</code>中定义一些样式。</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">devui-carousel-item-container</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">display</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> flex</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> relative</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  &amp; &gt; * {</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">flex</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre></div><p>我们在<code>App.vue</code>中使用下试试看：</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  &lt;div class=&quot;carousel-item&quot;&gt;page 1&lt;/div&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  &lt;div class=&quot;carousel-item&quot;&gt;page 2&lt;/div&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  &lt;div class=&quot;carousel-item&quot;&gt;page 3&lt;/div&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>效果如下：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/904606803804438bb2190a7d358b216c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p>这样基本功能就完成了，最后我们完善下样式。</p><p>给分页器加一个容器<code>carousel-pagination</code>，分页按钮加一个svg图标：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">&lt;div class=&quot;devui-carousel-pagination&quot;&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;button class=&quot;arrow arrow-left&quot; onClick={ prevPage }&gt;</span></span>
<span class="line"><span style="color:#babed8;">    &lt;svg width=&quot;18px&quot; height=&quot;18px&quot; viewBox=&quot;0 0 16 16&quot;&gt;&lt;g stroke=&quot;none&quot; stroke-width=&quot;1&quot; fill=&quot;none&quot; fill-rule=&quot;evenodd&quot;&gt;&lt;polygon fill=&quot;#293040&quot; fill-rule=&quot;nonzero&quot; points=&quot;10.7071068 12.2928932 9.29289322 13.7071068 3.58578644 8 9.29289322 2.29289322 10.7071068 3.70710678 6.41421356 8&quot;&gt;&lt;/polygon&gt;&lt;/g&gt;&lt;/svg&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;/button&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;button class=&quot;arrow arrow-right&quot; onClick={ nextPage }&gt;</span></span>
<span class="line"><span style="color:#babed8;">    &lt;svg width=&quot;18px&quot; height=&quot;18px&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot;&gt;&lt;g stroke=&quot;none&quot; stroke-width=&quot;1&quot; fill=&quot;none&quot; fill-rule=&quot;evenodd&quot;&gt;&lt;polygon fill=&quot;#293040&quot; fill-rule=&quot;nonzero&quot; transform=&quot;translate(8.146447, 8.000000) scale(-1, 1) translate(-8.146447, -8.000000) &quot; points=&quot;11.7071068 12.2928932 10.2928932 13.7071068 4.58578644 8 10.2928932 2.29289322 11.7071068 3.70710678 7.41421356 8&quot;&gt;&lt;/polygon&gt;&lt;/g&gt;&lt;/svg&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;/button&gt;</span></span>
<span class="line"><span style="color:#babed8;">&lt;/div&gt;</span></span></code></pre></div><p>在<code>carousel.scss</code>中添加以下样式：</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">devui-carousel</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> relative</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">overflow</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> hidden</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">devui-carousel-item-container</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">display</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> flex</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> relative</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">transition</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> left </span><span style="color:#F78C6C;">500ms</span><span style="color:#BABED8;"> ease </span><span style="color:#F78C6C;">0s</span><span style="color:#89DDFF;">;</span><span style="color:#BABED8;"> // 内容切换时的动效</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  &amp; &gt; * {</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">flex</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">devui-carousel-pagination</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> absolute</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100%</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">top</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">50%</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">display</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> flex</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">justify-content</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> space-between</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">margin-top</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">-18px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  .arrow {</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">cursor</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> pointer</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">36px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">36px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">border-radius</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">18px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-highlight-overlay</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">rgba</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">255</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">255</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">255</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.8</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">box-shadow</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-shadow-length-hover</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">4px</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">16px</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-light-shadow</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">rgba</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.1</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">display</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> inline-flex</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">align-items</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> center</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">justify-content</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> center</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">border</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">outline</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">transition</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> background-color </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-animation-duration-slow</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.3s</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-animation-ease-in-out-smooth</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">cubic-bezier</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">.645</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.045</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.355</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">));</span><span style="color:#BABED8;"> // 按钮hover时的动效</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    &amp;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;">hover {</span></span>
<span class="line"><span style="color:#BABED8;">      background: </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-area</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#BABED8;">f8f8f8</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    &amp;</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">arrow-left</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#B2CCD6;">margin-left</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">20px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    &amp;</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">arrow-right</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#B2CCD6;">margin-right</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">20px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre></div><p>这样一个基础的Carousel组件就完成啦！</p><p>效果：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd2ec70a43654bbbbc180589f02ba264~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.37.00.gif"></p><p>把内容换成掘金的图片试试：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">&lt;DCarousel style=&quot;width: 470px; height: 280px;&quot;&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;img src=&quot;https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a4dda7abf534e098f04fe0e968b1e0c~tplv-k3u1fbpfcp-zoom-mark-crop-v2:0:0:940:560.awebp?&quot; height=&quot;280&quot; /&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;img src=&quot;https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5e5b0b404fcb44ac9fb1359334186b46~tplv-k3u1fbpfcp-zoom-mark-crop-v2:0:0:940:560.awebp?&quot; height=&quot;280&quot; /&gt;</span></span>
<span class="line"><span style="color:#babed8;">&lt;/DCarousel&gt;</span></span></code></pre></div><p>效果：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/083b5af75b534211a7af93750b035ba0~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.37.43.gif"></p><p>是不是已经和掘金活动页的轮播图非常接近了？</p><h2 id="_4-加上分页指示器" tabindex="-1">4 加上分页指示器 <a class="header-anchor" href="#_4-加上分页指示器" aria-label="Permalink to &quot;4 加上分页指示器&quot;">​</a></h2><p>分页指示器兼具显示当前页码和分页两个功能，实现起来却非常简单。</p><p>先在<code>carousel.tsx</code>中增加：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">import { defineComponent, renderSlot, useSlots } from &#39;vue&#39;</span></span>
<span class="line"><span style="color:#babed8;">import usePage from &#39;./composables/use-page&#39;</span></span>
<span class="line"><span style="color:#babed8;">import &#39;./carousel.scss&#39;</span></span>
<span class="line"><span style="color:#babed8;"></span></span>
<span class="line"><span style="color:#babed8;">export default defineComponent({</span></span>
<span class="line"><span style="color:#babed8;">  name: &#39;DCarousel&#39;,</span></span>
<span class="line"><span style="color:#babed8;">  setup() {</span></span>
<span class="line"><span style="color:#babed8;">    const { pageIndex, prevPage, nextPage, setPageIndex } = usePage(1) // 跳转特定页码时，需要使用到setPageIndex方法</span></span>
<span class="line"><span style="color:#babed8;">    const count = useSlots().default().length</span></span>
<span class="line"><span style="color:#babed8;">    const indicatorArr = Array.from(new Array(count).keys()) // 生成指示器数组</span></span>
<span class="line"><span style="color:#babed8;">    </span></span>
<span class="line"><span style="color:#babed8;">    return () =&gt; {</span></span>
<span class="line"><span style="color:#babed8;">      return &lt;div class=&quot;devui-carousel&quot;&gt;</span></span>
<span class="line"><span style="color:#babed8;">        ...</span></span>
<span class="line"><span style="color:#babed8;">        </span></span>
<span class="line"><span style="color:#babed8;">        // 新增指示器</span></span>
<span class="line"><span style="color:#babed8;">        &lt;div class=&quot;devui-carousel-indicator&quot;&gt;</span></span>
<span class="line"><span style="color:#babed8;">          {</span></span>
<span class="line"><span style="color:#babed8;">            indicatorArr.map((item, index) =&gt; {</span></span>
<span class="line"><span style="color:#babed8;">              return &lt;div class={\`devui-carousel-indicator-item\${pageIndex.value === index+1 ? &#39; active&#39; : &#39;&#39;}\`} onClick={() =&gt; setPageIndex(index + 1)}&gt;&lt;/div&gt;</span></span>
<span class="line"><span style="color:#babed8;">            })</span></span>
<span class="line"><span style="color:#babed8;">          }</span></span>
<span class="line"><span style="color:#babed8;">        &lt;/div&gt;</span></span>
<span class="line"><span style="color:#babed8;">      &lt;/div&gt;</span></span>
<span class="line"><span style="color:#babed8;">    }</span></span>
<span class="line"><span style="color:#babed8;">  }</span></span>
<span class="line"><span style="color:#babed8;">})</span></span></code></pre></div><p>再完善下样式即可：</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">devui-carousel-indicator</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">display</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> flex</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> absolute</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">bottom</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">12px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">justify-content</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> center</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100%</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  .devui-carousel-indicator-item {</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">cursor</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> pointer</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">6px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">6px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">border-radius</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">margin-right</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">8px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-icon-fill</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#BABED8;">d3d5d9</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    &amp;.active {</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">24px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-list-item-active-bg</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#BABED8;">5e7ce0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#B2CCD6;">transition</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> all </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-animation-duration-slow</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.3s</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-animation-ease-in-smooth</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">cubic-bezier</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">.645</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.045</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.355</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">));</span><span style="color:#BABED8;"> // 切换内容时指示器小圆点上的动效</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre></div><p>效果如下：</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5fbed4c2e39444d2bb195e7b9860faa4~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.29.42.gif"></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b4a0ace7ab994f14a01cbfe6ab4bd410~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.30.12.gif"></p><p>至此，功能完备的<code>Carousel</code>组件已经实现，用起来也非常简单，只需要把需要轮播的内容放到组件里面即可。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">&lt;DCarousel&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;div class=&quot;carousel-item&quot;&gt;page 1&lt;/div&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;div class=&quot;carousel-item&quot;&gt;page 2&lt;/div&gt;</span></span>
<span class="line"><span style="color:#babed8;">  &lt;div class=&quot;carousel-item&quot;&gt;page 3&lt;/div&gt;</span></span>
<span class="line"><span style="color:#babed8;">&lt;/DCarousel&gt;</span></span></code></pre></div><h2 id="_5-组件的分层和-api-设计" tabindex="-1">5 组件的分层和 api 设计 <a class="header-anchor" href="#_5-组件的分层和-api-设计" aria-label="Permalink to &quot;5 组件的分层和 api 设计&quot;">​</a></h2><p>不过大家会发现这个<code>Carousel</code>组件还不能进行自定义，如果使用这个组件的开发者：</p><ul><li>想调整<code>左右分页器</code>的样式和位置</li><li>想调整<code>分页指示器</code>的样式和位置</li></ul><p>目前是做不到的。</p><p>还记得我们提到<a href="https://juejin.cn/post/7047503485054484516" target="_blank" rel="noreferrer">积木理论</a>有一个<code>抽象</code>的思想，前面我们通过<code>抽象</code>的思想将<code>Carousel</code>最核心的交互抽象成了<code>usePage</code>这个<code>composable</code>。</p><p>除了<code>抽象</code>之外，积木理论有一个<code>分层</code>的核心思想，这个可以利用<code>分层</code>的思想将组件的能力暴露给外部使用者，可以在保持组件简洁性的同时，给开发者提供更大的灵活性。</p><p>比如用户想改变分页指示器的位置，将其放在轮播主体区域的外面，我们要怎么实现呢？</p><p>业界组件库的做法可能会增加一个api，比如<code>Element Plus</code>增加了一个<code>indicator-position</code>的api去实现这个功能，将这个值设置为<code>outside</code>，分页指示器就会在外面。</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fae13563893344fcb3ae56ef210685ce~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p>这样做会有一个问题，就是如果我想将分页指示器放在左下角怎么办呢？</p><p>比如B站这种：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7bff3c2bc6584f0680176513061d837c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p>是不是又要给<code>indicator-position</code>加一个<code>bottom-left</code>之类的呢？如果用户想放在上面、右边等其他位置呢？</p><p>与其不断地给组件加api，不如将组件内部的能力暴露出去，让开发者自己随心所欲地布局，想放哪里放哪里。</p><p>具体要怎么实现呢？我们一起来试试看吧。</p><h3 id="_5-1-抽离子组件" tabindex="-1">5.1 抽离子组件 <a class="header-anchor" href="#_5-1-抽离子组件" aria-label="Permalink to &quot;5.1 抽离子组件&quot;">​</a></h3><p>抽离子组件分成三步：</p><ol><li>新建<code>carousel-indicator</code>子组件，将相应的模板内容拷贝过去</li><li>拷贝<code>carousel-indicator</code>子组件相关的样式</li><li>将<code>carousel</code>中和<code>carousel-indicator</code>相关的代码删除，并用子组件替换</li></ol><h4 id="_5-1-1-新建子组件" tabindex="-1">5.1.1 新建子组件 <a class="header-anchor" href="#_5-1-1-新建子组件" aria-label="Permalink to &quot;5.1.1 新建子组件&quot;">​</a></h4><p>第一步是将需要定制的部分从<code>Carousel</code>组件中抽离出来，比如我们想定制分页指示器（Carousel Indicator），那我们就把它抽离成子组件<code>carousel-indicator</code>。</p><p>在<code>carousel/src</code>中新建一个<code>components</code>的目录，用来存放<code>Carousel</code>的子组件。</p><p>我们先在<code>components</code>下建一个<code>carousel-indicator.tsx</code>文件，然后将<code>carousel.tsx</code>文件中和指示器相关的代码拷贝到该文件中。</p><p>为了方便<code>carousel-indicator</code>的状态与<code>carousel</code>保持同步，比如：</p><ul><li>通过分页器切换页码时，指示器也应该相应高亮</li><li>通过指示器切换页码时，内容也应该相应的切换</li></ul><p>我们给<code>carousel-indicator</code>加一个双向绑定，绑定当前页码。</p><p>另外需要增加一个<code>count</code>以便于<code>carousel-indicator</code>渲染指定数量的小圆点。</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">import { defineComponent } from &#39;vue&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import &#39;./carousel-indicator.scss&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">export default defineComponent({</span></span>
<span class="line"><span style="color:#BABED8;">  name: &#39;DCarouselIndicator&#39;,</span></span>
<span class="line"><span style="color:#BABED8;">  props: {</span></span>
<span class="line"><span style="color:#BABED8;">    modelValue: {</span></span>
<span class="line"><span style="color:#BABED8;">      type: Number,</span></span>
<span class="line"><span style="color:#BABED8;">    },</span></span>
<span class="line"><span style="color:#BABED8;">    count: {</span></span>
<span class="line"><span style="color:#BABED8;">      type: Number,</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">  },</span></span>
<span class="line"><span style="color:#BABED8;">  emits: [&#39;update:modelValue&#39;],</span></span>
<span class="line"><span style="color:#BABED8;">  setup(props, { emit }) {</span></span>
<span class="line"><span style="color:#BABED8;">    const indicatorArr = Array.from(new Array(props.count).keys())</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    return () =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">      return </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devui-carousel-indicator</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        {</span></span>
<span class="line"><span style="color:#BABED8;">          indicatorArr.map((item, index) =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">            return &lt;div class={\`devui-carousel-indicator-item\${props.modelValue === index+1 ? &#39; active&#39; : &#39;&#39;}\`} onClick={() =&gt; emit(&#39;update:modelValue&#39;, index + 1)}&gt;</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">          })</span></span>
<span class="line"><span style="color:#BABED8;">        }</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">})</span></span></code></pre></div><h4 id="_5-1-2-拷贝样式" tabindex="-1">5.1.2 拷贝样式 <a class="header-anchor" href="#_5-1-2-拷贝样式" aria-label="Permalink to &quot;5.1.2 拷贝样式&quot;">​</a></h4><p>第二步就是将相应的样式也拷贝过去，新建一个<code>carousel-indicator.scss</code>文件：</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">devui-carousel-indicator</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  ... // 从carousel.scss中拷贝过来的</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="_5-1-3-替换子组件" tabindex="-1">5.1.3 替换子组件 <a class="header-anchor" href="#_5-1-3-替换子组件" aria-label="Permalink to &quot;5.1.3 替换子组件&quot;">​</a></h4><p>第三步就是将<code>carousel</code>中和<code>carousel-indicator</code>相关的代码删除，使用子组件替换。</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devui-carousel-indicator</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  {</span></span>
<span class="line"><span style="color:#BABED8;">    indicatorArr.map((item, index) =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">      return &lt;div class={\`devui-carousel-indicator-item\${pageIndex.value === index+1 ? &#39; active&#39; : &#39;&#39;}\`} onClick={() =&gt; setPageIndex(index + 1)}&gt;</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    })</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>-&gt;</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">count</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">{count}</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">v-model</span><span style="color:#89DDFF;">={</span><span style="color:#BABED8;">pageIndex.value</span><span style="color:#89DDFF;">}&gt;&lt;/</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>测试下效果和之前没有任何差别：</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2cf0521eb81148bfb0354806c828eb6e~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.31.27.gif"></p><h3 id="_5-2-增加-indicator-插槽" tabindex="-1">5.2 增加 indicator 插槽 <a class="header-anchor" href="#_5-2-增加-indicator-插槽" aria-label="Permalink to &quot;5.2 增加 indicator 插槽&quot;">​</a></h3><p>在<code>carousel</code>增加<code>indicator</code>插槽逻辑：</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">{</span></span>
<span class="line"><span style="color:#BABED8;">  slots.indicator</span></span>
<span class="line"><span style="color:#BABED8;">  ? slots.indicator()</span></span>
<span class="line"><span style="color:#BABED8;">  : </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">count</span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;">{count}</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">v-model</span><span style="color:#89DDFF;">={</span><span style="color:#BABED8;">pageIndex.value</span><span style="color:#89DDFF;">}&gt;&lt;/</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre></div><h3 id="_5-3-将子组件暴露出去" tabindex="-1">5.3 将子组件暴露出去 <a class="header-anchor" href="#_5-3-将子组件暴露出去" aria-label="Permalink to &quot;5.3 将子组件暴露出去&quot;">​</a></h3><p>在<code>carousel/index.ts</code>文件中将<code>DCarouselIndicator</code>暴露出去。</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">import { App } from &#39;vue&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import DCarousel from &#39;./src/carousel&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import DCarouselIndicator from &#39;./src/components/carousel-indicator&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">export { DCarousel, DCarouselIndicator }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">export default {</span></span>
<span class="line"><span style="color:#BABED8;">  install(app: App) {</span></span>
<span class="line"><span style="color:#BABED8;">    app.component(DCarousel.name, DCarousel)</span></span>
<span class="line"><span style="color:#BABED8;">    app.component(DCarouselIndicator.name, DCarouselIndicator)</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre></div><p>我们尝试在<code>App.vue</code>使用下子组件：</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">setup</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">lang</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">DCarousel</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">DCarouselIndicator</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">usePage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./components/carousel</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#BABED8;"> pageIndex </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">usePage</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 2</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#C792EA;">indicator</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">:count</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">v-model</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pageIndex</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">style</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">justify-content: flex-start;padding-left: 12px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>我们发现指示器的位置已经移到了左下角，不过点击指示器并没有切换内容，点击左右分页器也没能改变指示器的高亮状态。</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f24ac137ac134218b0c49d62583013a6~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.26.33.gif"></p><p>这是什么原因呢？</p><h3 id="_5-4-父子组件状态同步" tabindex="-1">5.4 父子组件状态同步 <a class="header-anchor" href="#_5-4-父子组件状态同步" aria-label="Permalink to &quot;5.4 父子组件状态同步&quot;">​</a></h3><p>我们发现指示器的状态和内容切换的状态并不是同步的：</p><ul><li>指示器的状态绑定的是<code>App.vue</code>中的<code>pageIndex</code>值</li><li>内容切换的状态绑定的是<code>carousel</code>组件里面的<code>pageIndex</code>值</li></ul><p>因此要想办法将两者的状态同步，可以给<code>carousel</code>组件增加一个<code>v-model</code>双向绑定。</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">import { defineComponent, renderSlot, useSlots, watch, toRefs } from &#39;vue&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import usePage from &#39;./composables/use-page&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import DCarouselIndicator from &#39;./components/carousel-indicator&#39;</span></span>
<span class="line"><span style="color:#BABED8;">import &#39;./carousel.scss&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">export default defineComponent({</span></span>
<span class="line"><span style="color:#BABED8;">  name: &#39;DCarousel&#39;,</span></span>
<span class="line"><span style="color:#BABED8;">  components: {</span></span>
<span class="line"><span style="color:#BABED8;">    DCarouselIndicator,</span></span>
<span class="line"><span style="color:#BABED8;">  },</span></span>
<span class="line"><span style="color:#BABED8;">  props: {</span></span>
<span class="line"><span style="color:#BABED8;">    modelValue: {</span></span>
<span class="line"><span style="color:#BABED8;">      type: Number</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">  },</span></span>
<span class="line"><span style="color:#BABED8;">  emits: [&#39;update:modelValue&#39;],</span></span>
<span class="line"><span style="color:#BABED8;">  setup(props, { slots, emit }) {</span></span>
<span class="line"><span style="color:#BABED8;">    const { modelValue } = toRefs(props)</span></span>
<span class="line"><span style="color:#BABED8;">    const { pageIndex, prevPage, nextPage } = usePage(1)</span></span>
<span class="line"><span style="color:#BABED8;">    const count = useSlots().default().length</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    // 同步监听外部modelValue和内部pageIndex的变化，实现父子组件状态同步</span></span>
<span class="line"><span style="color:#BABED8;">    watch(modelValue, (newVal: number) =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">      pageIndex.value = newVal</span></span>
<span class="line"><span style="color:#BABED8;">    })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    watch(pageIndex, (newVal: number) =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">      emit(&#39;update:modelValue&#39;, newVal)</span></span>
<span class="line"><span style="color:#BABED8;">    })</span></span>
<span class="line"><span style="color:#BABED8;">    </span></span>
<span class="line"><span style="color:#BABED8;">    return () =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">      return </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devui-carousel</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        ...</span></span>
<span class="line"><span style="color:#BABED8;">        &lt;div class=&quot;devui-carousel-pagination&quot;&gt;</span></span>
<span class="line"><span style="color:#BABED8;">          &lt;button class=&quot;arrow arrow-left&quot; onClick={() =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">            emit(&#39;update:modelValue&#39;, props.modelValue - 1) // 通过分页器切换时需要同步修改modelValue，确保外部指示器状态得到同步</span></span>
<span class="line"><span style="color:#BABED8;">            prevPage()</span></span>
<span class="line"><span style="color:#BABED8;">          }}&gt;</span></span>
<span class="line"><span style="color:#BABED8;">            &lt;svg&gt;</span></span>
<span class="line"><span style="color:#BABED8;">          &lt;/button&gt;</span></span>
<span class="line"><span style="color:#BABED8;">          &lt;button class=&quot;arrow arrow-right&quot; onClick={() =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">            emit(&#39;update:modelValue&#39;, props.modelValue + 1)</span></span>
<span class="line"><span style="color:#BABED8;">            nextPage()</span></span>
<span class="line"><span style="color:#BABED8;">          }}&gt;</span></span>
<span class="line"><span style="color:#BABED8;">            &lt;svg&gt;</span></span>
<span class="line"><span style="color:#BABED8;">          &lt;/button&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        ...</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    }</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">})</span></span></code></pre></div><p>在<code>App.vue</code>中，让<code>DCarousel</code>和<code>DCarouselIndicator</code>组件绑定同一个<code>pageIndex</code>即可</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">v-model</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pageIndex</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> // 给DCarousel增加v-model</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 2</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#C792EA;">indicator</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">:count</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">v-model</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pageIndex</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">style</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">justify-content: flex-start;padding-left: 12px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>这时我们再次：</p><ul><li>点击分页器，指示器状态会相应变化</li><li>点击指示器，页面内容也会相应地切换</li></ul><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f0d1a932ebed4b6293680f9f4ed3e7cc~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.24.57.gif"></p><h3 id="_5-5-要定制指示器样式怎么办" tabindex="-1">5.5 要定制指示器样式怎么办 <a class="header-anchor" href="#_5-5-要定制指示器样式怎么办" aria-label="Permalink to &quot;5.5 要定制指示器样式怎么办&quot;">​</a></h3><p>如果用户想要更多的定制能力，比如定制指示器的样式，改成B站这种小圆点的形式。</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7bff3c2bc6584f0680176513061d837c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p>这时我们内置的<code>DCarouselIndicator</code>组件已经满足不了用户的需求，需要做更深一层的定制，先给<code>DCarouselIndicator</code>组件增加默认插槽。</p><p>在<code>carousel-indicator.tsx</code>文件中增加：</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">setup(props, { emit, slots }) {</span></span>
<span class="line"><span style="color:#BABED8;">  const indicatorArr = Array.from(new Array(props.count).keys())</span></span>
<span class="line"><span style="color:#BABED8;">  </span></span>
<span class="line"><span style="color:#BABED8;">  return () =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">    return </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">devui-carousel-indicator</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      {</span></span>
<span class="line"><span style="color:#BABED8;">        slots.default</span></span>
<span class="line"><span style="color:#BABED8;">        ? slots.default() // 增加默认插槽</span></span>
<span class="line"><span style="color:#BABED8;">        : indicatorArr.map((item, index) =&gt; {</span></span>
<span class="line"><span style="color:#BABED8;">          return &lt;div class={\`devui-carousel-indicator-item\${props.modelValue === index+1 ? &#39; active&#39; : &#39;&#39;}\`} onClick={() =&gt; emit(&#39;update:modelValue&#39;, index + 1)}&gt;</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        })</span></span>
<span class="line"><span style="color:#BABED8;">      }</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  }</span></span>
<span class="line"><span style="color:#BABED8;">}</span></span></code></pre></div><p>在<code>App.vue</code>中自定义指示器：</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">setup</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">lang</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">DCarousel</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">DCarouselIndicator</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">usePage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./components/carousel</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#BABED8;"> pageIndex</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> setPageIndex </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">usePage</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">) </span><span style="color:#676E95;font-style:italic;">// setPageIndex用于自定义指示器的页面跳转</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> indicatorArr </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">Array</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">3</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">keys</span><span style="color:#BABED8;">()) </span><span style="color:#676E95;font-style:italic;">// 用于渲染指示器元素的数组</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">v-model</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pageIndex</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 2</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">carousel-item</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">page 3</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#C792EA;">indicator</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">:count</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">v-model</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pageIndex</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">style</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">justify-content: flex-start;padding-left: 12px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">          // 自定义指示器</span></span>
<span class="line"><span style="color:#BABED8;">          </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#C792EA;">:class</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">[&#39;carousel-indicator-item&#39;, pageIndex === item+1 ? &#39;active&#39; : &#39;&#39;]</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#C792EA;">v-for</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">item of indicatorArr</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#C792EA;">:key</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">item</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#C792EA;">@click</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">setPageIndex(item+1)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> // </span><span style="color:#C792EA;">自定义指示器的跳转事件</span></span>
<span class="line"><span style="color:#89DDFF;">          &gt;&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">DCarouselIndicator</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">DCarousel</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">carousel-item</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">text-align</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> center</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">line-height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">200px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">rgb</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">135</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">164</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">186</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">// 自定义指示器的样式</span></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">carousel-indicator-item</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> relative</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">display</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> inline-block</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">8px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">8px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">margin</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">4px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">border-radius</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">50%</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">background-color</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">var</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">--devui-icon-fill</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#BABED8;">d3d5d9</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">overflow</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> hidden</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">cursor</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> pointer</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">carousel-indicator-item</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">active</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">14px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">14px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">margin</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">border-radius</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">50%</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">background-color</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#BABED8;">fff</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>效果：</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/70f56bebe29248928058d04e4d24710a~tplv-k3u1fbpfcp-watermark.image?" alt="2022-01-10 08.23.55.gif"></p><h3 id="_5-7-还想自定义分页器" tabindex="-1">5.7 还想自定义分页器？ <a class="header-anchor" href="#_5-7-还想自定义分页器" aria-label="Permalink to &quot;5.7 还想自定义分页器？&quot;">​</a></h3><p>照着自定义分页指示器的思路，将分页器抽成子组件<code>CarouselPagination</code>，暴露出去，并增加相应的插槽即可。</p><p>一旦将组件内部的能力抽离出来，并暴露出去了，用户可以定制的空间就更大了。</p><p>比如：</p><ol><li>用户可以用我们暴露出去的<code>usePage</code>核心分页能力去写自己的<code>Pagination</code>分页组件、<code>ImagePreview</code>图片预览组件</li><li>可以使用<code>CarouselIndicator</code>和<code>CarouselPagination</code>子组件积木去拼接自己想要的几乎任意的走马灯效果，等于原来是一个整体不可拆分的Carousel组件，现在将其拆分成几个更小的小积木，让用户可以自己拼Carousel，也可以自己做一个相应的小积木零件，拼接到Carousel中，形成个性化的Carousel组件</li></ol>`,145);function r(D,y,F,i,B,d){const s=n("EditInfo");return l(),p("div",null,[c,o(s,{time:"2022年01月10日 08:38",title:"阅读 3894 ·  点赞 48 ·  评论 20 ·  收藏 74"})])}const E=a(t,[["render",r]]);export{A as __pageData,E as default};
