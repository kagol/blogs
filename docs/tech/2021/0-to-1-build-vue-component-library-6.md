# ä»0åˆ°1æ­å»ºVueç»„ä»¶åº“06ï¼šæ‰‹æŠŠæ‰‹å¸¦ä½ å¼€å‘ä¸€ä¸ªè„šæ‰‹æ¶

![image](https://user-images.githubusercontent.com/9566362/201511144-b05b690e-7294-4d9f-ad8c-d5c707fc43fd.png)

æœ¬æ–‡ä½œè€…ï¼š[iel](https://juejin.cn/user/1538972011203662)

åŸæ–‡é“¾æ¥ï¼š[https://juejin.cn/post/7021870182855344142](https://juejin.cn/post/7021870182855344142)

æœ€è¿‘åœ¨ä¸[æ‘é•¿](https://space.bilibili.com/480140591)è€å¸ˆä¸€èµ·åš[ç›´æ’­](https://www.bilibili.com/video/BV1Z64y187dR)ï¼Œç»™å¤§å®¶åˆ†äº«[vue devui](https://gitee.com/devui/vue-devui)å¼€æºç»„ä»¶åº“çš„å»ºè®¾ï¼Œ1-3æœŸä»¥ tree ç»„ä»¶ä¸ºæ —å­ğŸŒ°ï¼Œä»‹ç»äº†å¦‚ä½•è®¾è®¡å’Œå¼€å‘Vueç»„ä»¶ï¼š
1. [Vue DevUIå¼€æºæŒ‡å—01ï¼šæäº¤æˆ‘çš„ç¬¬ä¸€æ¬¡pr](https://juejin.cn/post/7009273646884028430)
1. [Vue DevUIå¼€æºæŒ‡å—02ï¼šå®ç°ä¸€ä¸ªèƒ½æ¸²æŸ“å¤šå±‚èŠ‚ç‚¹çš„Treeç»„ä»¶](https://juejin.cn/post/7011535488171376671)
1. [Vue DevUIå¼€æºæŒ‡å—03ï¼šå¦‚ä½•ç»™ tree ç»„ä»¶å¢åŠ å±•å¼€/æ”¶èµ·åŠŸèƒ½](https://juejin.cn/post/7015023354847428645)

ä»ç¬¬4æœŸå¼€å§‹ç»™å¤§å®¶åˆ†äº«ç»„ä»¶åº“å·¥ç¨‹åŒ–ç›¸å…³çš„å†…å®¹ï¼š
1. [ã€æˆ‘è¦åšå¼€æºã€‘Vue DevUIå¼€æºæŒ‡å—04ï¼šä½¿ç”¨Viteæ­å»ºä¸€ä¸ªæ”¯æŒTypeScript/JSXçš„Vue3ç»„ä»¶åº“å·¥ç¨‹ ](https://juejin.cn/post/7017101147865350158)
1. [ã€æˆ‘è¦åšå¼€æºã€‘Vue DevUIå¼€æºæŒ‡å—05ï¼šç»™Vue3ç»„ä»¶åº“æ·»åŠ VitePressæ–‡æ¡£ç³»ç»Ÿ ](https://juejin.cn/post/7019314307682795534)

åç»­çš„ç›´æ’­ä¹Ÿä¼šåˆ†æˆä¸¤æ¡çº¿ï¼š
1. ä¸€æ¡æ˜¯ç»„ä»¶çš„è®¾è®¡å’Œå®ç°
1. å¦ä¸€æ¡æ˜¯ç»„ä»¶åº“çš„å·¥ç¨‹åŒ–

æ¬¢è¿å¤§å®¶æŒç»­å…³æ³¨ï½

æˆ‘ä»¬ `DevUI` å›¢é˜Ÿæœ‰å¤šä¸ªå¼€æºé¡¹ç›®ï¼Œç°åœ¨éƒ½åœ¨æ‹›å‹Ÿ`contributor`ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·å‚ä¸å¼€æºä¸­æ¥ï¼(æ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥æ·»åŠ `DevUI`å°åŠ©æ‰‹çš„å¾®ä¿¡ï¼š`devui-official`ï¼Œå°†ä½ æ‹‰åˆ°æˆ‘ä»¬çš„æ ¸å¿ƒå¼€å‘ç¾¤)

- Ng DevUI: [https://github.com/DevCloudFE/ng-devui](https://github.com/DevCloudFE/ng-devui)
- Vue DevUI: [https://gitee.com/devui/vue-devui](https://gitee.com/devui/vue-devui)
- DevUI Admin [https://github.com/DevCloudFE/ng-devui-admin](https://github.com/DevCloudFE/ng-devui-admin)

`DevUI`å®˜ç½‘ï¼š[https://devui.design/](https://devui.design/)

## ä¸Šä¸€æœŸå†…å®¹å›é¡¾

ä¸Šä¸€æœŸä¸»è¦ç»™å¤§å®¶åˆ†äº«äº†ä¸¤éƒ¨åˆ†å†…å®¹ï¼š
- ä½¿ç”¨vitepressæ­å»ºç»„ä»¶åº“çš„æ–‡æ¡£ç³»ç»Ÿ
- ç»™æ–‡æ¡£ç³»ç»Ÿå¢åŠ demoå±•å¼€/æ”¶èµ·åŠŸèƒ½

æœ¬æœŸé‚€è¯·äº†`Vue DevUI`å›¢é˜Ÿçš„[é›·åŒå­¦](https://juejin.cn/user/1538972011203662)ç»™å¤§å®¶åˆ†äº«`DevUI CLI`å·¥å…·çš„å®ç°åŸç†ã€‚

é›·åŒå­¦æ˜¯æˆ‘ä»¬Vue DevUIçš„æ—©æœŸè´¡çŒ®è€…ï¼Œä¹Ÿæ˜¯Toastç»„ä»¶çš„ç”°ä¸»ï¼Œæ—©æœŸVue DevUIç»„ä»¶åº“è¿˜å¾ˆä¸å®Œå–„ï¼Œç»„ä»¶çš„æ–‡ä»¶å’Œç»„ä»¶åº“çš„å…¥å£æ–‡ä»¶éƒ½æ˜¯æ‰‹åŠ¨æ·»åŠ çš„ï¼Œæ¯æ¬¡æ–°å¢ä¸€ä¸ªç»„ä»¶ï¼Œéƒ½éå¸¸éº»çƒ¦ï¼Œéœ€è¦
1. å…ˆåœ¨`devui`ç›®å½•ä¸‹åˆ›å»ºä¸€å †æ–‡ä»¶`index.ts`/`src/xx.tsx`ç­‰
2. åœ¨`devui/vue-devui.ts`ç»„ä»¶åº“å…¥å£æ–‡ä»¶ä¸­æ·»åŠ ç›¸åº”çš„ç»„ä»¶å¯¼å‡º
3. åœ¨`sidebar.ts`å·¦ä¾§ç»„ä»¶èœå•ä¸­æ·»åŠ ç›¸åº”çš„ç»„ä»¶é…ç½®

è€Œä¸”åƒ`vue-devui.ts`/`sidebar.ts`ç­‰å…¬å…±æ–‡ä»¶ï¼Œç»å¸¸å¤šä¸ªç”°ä¸»ä¸€èµ·ä¿®æ”¹ï¼Œç»å¸¸å¯¼è‡´å†²çªã€‚

é›·åŒå­¦æ•é”å¾—å‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸»åŠ¨æå‡ºåˆ›å»ºä¸€ä¸ª`DevUI CLI`å·¥å…·æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ¬æœŸç›´æ’­é›·åŒå­¦å°±ç»™å¤§å®¶åˆ†äº«äº†`DevUI CLI`çš„å®ç°åŸç†ã€‚

è¿™åªæ˜¯`DevUI CLI`å·¥å…·ç³»åˆ—çš„[ç¬¬ä¸€æœŸ](https://juejin.cn/post/7021870182855344142)ï¼Œåç»­è¿˜ä¼šç»§ç»­æ·±å…¥å¦‚ä½•ä½¿ç”¨`DevUI CLI`ï¼š
- ä¸ºç»„ä»¶åº“ç”Ÿæˆå…¥å£æ–‡ä»¶
- åˆ›å»ºç»„ä»¶ç›®å½•ç»“æ„
- è‡ªåŠ¨ç”Ÿæˆå·¦ä¾§ç»„ä»¶èœå•æ–‡ä»¶

ä»¥ä¸‹æ˜¯åŸæ–‡ï¼š

> è„šæ‰‹æ¶æ˜¯ä¸ºäº†ä¿è¯å„æ–½å·¥è¿‡ç¨‹é¡ºåˆ©è¿›è¡Œè€Œæ­è®¾çš„å·¥ä½œå¹³å°ã€‚æŒ‰æ­è®¾çš„ä½ç½®åˆ†ä¸ºå¤–è„šæ‰‹æ¶ã€é‡Œè„šæ‰‹æ¶ï¼›æŒ‰ææ–™ä¸åŒå¯åˆ†ä¸ºæœ¨è„šæ‰‹æ¶ã€ç«¹è„šæ‰‹æ¶ã€é’¢ç®¡è„šæ‰‹æ¶ï¼›æŒ‰æ„é€ å½¢å¼åˆ†ä¸ºç«‹æ†å¼è„šæ‰‹æ¶ã€æ¡¥å¼è„šæ‰‹æ¶ã€é—¨å¼è„šæ‰‹æ¶ã€æ‚¬åŠå¼è„šæ‰‹æ¶ã€æŒ‚å¼è„šæ‰‹æ¶ã€æŒ‘å¼è„šæ‰‹æ¶ã€çˆ¬å¼è„šæ‰‹æ¶ã€‚ â€”â€”ç™¾åº¦ç™¾ç§‘

æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªä¾¿åˆ©å·¥å…·ï¼Œä¸ºä¸€äº›æ¯”è¾ƒç‰¹æ®Šæˆ–ç¹ççš„å·¥ä½œæä¾›è¾…åŠ©ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦å¼€å‘çš„æ˜¯ä¸€ä¸ªåŸºäºå‘½ä»¤è¡Œçš„å·¥å…·ï¼Œåæ–‡ä»¥ `cli` ä»£æ›¿ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦å¼€å‘ä¸€ä¸ªè„šæ‰‹æ¶ï¼Ÿ

ä»¥ä¸‹ä¸ºåˆæœŸç»„ä»¶åº“ååŒå¼€å‘æ—¶é‡åˆ°çš„é—®é¢˜ï¼š

- ç»„ä»¶ç›®å½•ç»“æ„ä¸ä¸€è‡´
  + æ‰å¹³åŒ–ç›®å½•
  + `src` å‹ç›®å½•
- ç»„ä»¶äº§å‡ºå‘½åä¸ä¸€è‡´
  + å‰ç¼€ `D` å‘½å
  + æ— å‰ç¼€ `D` å‘½å
  + å°å†™é©¼å³°å‘½å
  + å¤§å†™é©¼å³°å‘½å
  + `xxxService` å‘½å
  + `useXxxService` å‘½å
- ç»„ä»¶å…¥å£æ–‡ä»¶ç»å¸¸å†²çª

ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæœ¬ç€ä¸ºå¼€æºç¤¾åŒºåšè´¡çŒ®ï¼Œå‘å…‰å‘çƒ­çš„æ—¶å€™åˆ°äº†ï¼Œå’Œé¡¹ç›®ç»„ç»‡äºº `kagol` æ²Ÿé€šäº†è„šæ‰‹æ¶æ–¹æ¡ˆé¡ºåˆ©é€šè¿‡ï¼Œ`Prefect` ï¼

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fde0c795e07146a382691507c2fb646b~tplv-k3u1fbpfcp-watermark.awebp)

## TODO

- [x] åˆ›å»ºç»Ÿä¸€ç»„ä»¶ç»“æ„
- [x] åˆ›å»ºç»„ä»¶åº“å…¥å£æ–‡ä»¶

## æŠ€æœ¯é€‰å‹

è„šæ‰‹æ¶ = å‘½ä»¤ + äº¤äº’ + é€»è¾‘å¤„ç†

- å‘½ä»¤
  + `commander` æ’ä»¶æä¾›å‘½ä»¤æ³¨å†Œã€å‚æ•°è§£æã€æ‰§è¡Œå›è°ƒ
- äº¤äº’
  + `inquirer` æ’ä»¶ç”¨äºå‘½ä»¤è¡Œçš„äº¤äº’ï¼ˆé—®ç­”ï¼‰
- é€»è¾‘å¤„ç†
  + `fs-extra` æ’ä»¶æ˜¯å¯¹ `nodejs` æ–‡ä»¶ `Api` çš„è¿›ä¸€æ­¥å°è£…ï¼Œä¾¿äºä½¿ç”¨
  + `kolorist` æ’ä»¶ç”¨äºè¾“å‡ºé¢œè‰²ä¿¡æ¯è¿›è¡Œå‹å¥½æç¤º

## åˆå§‹åŒ– cli

### step1 åˆ›å»º cli ç›®å½•

```shell
mkdir devui-cli // åˆ›å»ºè„šæ‰‹æ¶ç›®å½•
cd devui-cli // è¿›å…¥è„šæ‰‹æ¶ç›®å½•
// åˆå§‹åŒ–ä¸€ä¸ª node é¡¹ç›®
npm init
// or
yarn init
```

ç¬¬ä¸€æ­¥å…ˆåˆ›å»ºä¸€ä¸ªç›®å½•æ¥å­˜æ”¾æˆ‘ä»¬å³å°†å¼€å‘çš„è„šæ‰‹æ¶ï¼Œä½œä¸ºä¸€ä¸ª `nodejs` åŒ…ï¼Œéœ€è¦æˆ‘ä»¬é€šè¿‡ `npm` æˆ–è€… `yarn` åˆå§‹åŒ–åŒ…çš„ä¿¡æ¯ï¼Œä¸€å¾‹å›è½¦å³å¯é€šè¿‡ï¼Œç”Ÿæˆåçš„ç›®å½•ç»“æ„å¦‚ä¸‹å›¾ã€‚


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9336fb2a081a43ed8b9a245926e0bc9d~tplv-k3u1fbpfcp-watermark.image?)

### step2 åˆ›å»ºå…¥å£æ–‡ä»¶

```shell
mkdir src
echo 'console.log("hello devui-cli")' > src/index.js
```

### step3 å®‰è£…æ‰€éœ€ä¾èµ–

```shell
npm i -D commander inquirer fs-extra kolorist
// or
yarn add -D commander inquirer fs-extra kolorist
```

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb0c9c878e1b45209b91690ef5e4488f~tplv-k3u1fbpfcp-watermark.image?)

## å¼€å‘å‘½ä»¤è„šæœ¬

è¿™é‡Œå…ˆç»™å¤§å®¶æ¢³ç†ä¸‹ `cli` çš„æ‰§è¡Œæµç¨‹ï¼šå‘½ä»¤è¡Œè¾“å…¥ `devui-cli` --> å‘½ä»¤è¡Œäº¤äº’ --> æ ¹æ®ä¸åŒå‚æ•°è¿›è¡Œä¸åŒæ“ä½œã€‚

è¿™é‡Œå¤§å®¶å¯èƒ½è¦é—®äº†ï¼Œå‘½ä»¤è¡Œå¦‚ä½•è¯†åˆ« `devui-cli` çš„ï¼Ÿåˆæ˜¯å¦‚ä½•æ‰§è¡Œäº¤äº’æ“ä½œçš„ï¼Ÿ

> è¿™é‡Œç®€å•ç»™å¤§å®¶è§£ç­”ä¸€ä¸‹ï¼Œå‘½ä»¤è¡Œé‡Œé¢è¾“å…¥ `devui-cli` æœ¬è´¨ä¸Šæ˜¯æ‰§è¡ŒæŸä¸€ä¸ªå¯æ‰§è¡Œè„šæœ¬ï¼Œé‚£ä¹ˆå¯¹åº”æˆ‘ä»¬ `node` åŒ…æ¥è¯´å°±æ˜¯å…¥å£æ–‡ä»¶ `src/index.js` äº†ï¼Œæ‰€ä»¥å¯ä»¥çœ‹æˆæ˜¯ `node src/index.js` ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ç¬¬ä¸€ç§æ›´ä¸ºæ–¹ä¾¿ä¸å‹å¥½ä¸€ç‚¹ã€‚é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æ‰§è¡Œæ˜¯å¦å°±å¯ä»¥äº†å‘¢ï¼Ÿç­”æ¡ˆè‚¯å®šä¸æ˜¯çš„ï¼Œéœ€è¦åœ¨ `package.json` é‡Œé¢é…ç½® `bin` å±æ€§æ¥æ ‡æ˜è„šæœ¬çš„ä¸€ä¸ªå…¥å£ã€‚

å‡†å¤‡å·¥ä½œç»“æŸï¼Œæ¥ä¸‹æ¥å¼€å§‹æ­£å¼çš„ `cli` è„šæœ¬ç¼–å†™ã€‚

### é…ç½®ç¯å¢ƒè§£é‡Šå™¨

```shell
#!/usr/bin/env node
```

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/11c52f6ad08b487d8c8a68ce6e80ca23~tplv-k3u1fbpfcp-watermark.image?)

éƒ¨åˆ†çœ‹å®˜å¯èƒ½ä¼šç–‘æƒ‘è¿™å¥è¯æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ

> ç­”æ¡ˆåœ¨è¿™é‡Œï¼Œè‹¥æ˜¯æœ‰ä½¿ç”¨è¿‡ `Linux` æˆ–è€… `Unix` çš„å°ä¼™ä¼´ä»¬ï¼Œå¯¹äº `Shebang` åº”è¯¥ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªç¬¦å·çš„åç§° `#!` ã€‚è¿™ä¸ªç¬¦å·é€šå¸¸åœ¨ `Unix` ç³»ç»Ÿçš„åŸºæœ¬ä¸­ç¬¬ä¸€è¡Œå¼€å¤´ä¸­å‡ºç°ï¼Œç”¨äºæŒ‡æ˜è¿™ä¸ªè„šæœ¬æ–‡ä»¶çš„è§£é‡Šç¨‹åºï¼Œ `#!/usr/bin/env node` ç›®çš„å°±æ˜¯å‘Šè¯‰æ“ä½œç³»ç»Ÿæ‰§è¡Œè¿™ä¸ªè„šæœ¬çš„æ—¶å€™ï¼Œåœ¨ `/usr/bin` çš„ç¯é…ç½®é‡Œæ‰¾åˆ° `node` è§£é‡Šå™¨å¹¶æ‰§è¡Œã€‚

### æ³¨å†Œå‘½ä»¤

é…ç½®å¥½ç¯å¢ƒè§£é‡Šå™¨ä¹‹åå°±å¯ä»¥ç¼–å†™æˆ‘ä»¬çš„å‘½ä»¤é€»è¾‘äº†ã€‚

é¦–å…ˆï¼Œå…ˆæ³¨å†Œä¸‹æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„ä¸€äº›å‘½ä»¤ä»¥åŠä¸€äº›å‘½ä»¤å‚æ•°ã€‚

```js
#!/usr/bin/env node
import { Command } from 'commander'
import { onCreate } from './commands/create'

// åˆ›å»ºå‘½ä»¤å¯¹è±¡
const program = new Command()

// æ³¨å†Œå‘½ä»¤ã€å‚æ•°ã€å›è°ƒ
program
  // æ³¨å†Œ create å‘½ä»¤
  .command('create')
  // æ·»åŠ å‘½ä»¤æè¿°
  .description('åˆ›å»ºä¸€ä¸ªç»„ä»¶æ¨¡æ¿æˆ–é…ç½®æ–‡ä»¶')
  // æ·»åŠ å‘½ä»¤å‚æ•° -t | --type <type> ï¼Œ<type> è¡¨ç¤ºè¯¥å‚æ•°å¿…å¡«ï¼Œ[type] è¡¨ç¤ºé€‰å¡«
  .option('-t --type <type>', `åˆ›å»ºç±»å‹ï¼Œå¯é€‰å€¼ï¼šcomponent, lib-entry`)
  // æ³¨å†Œå‘½ä»¤å›è°ƒ
  .action(onCreate)

// æ‰§è¡Œå‘½ä»¤è¡Œå‚æ•°è§£æ
program.parse()

```

åˆ›å»ºå…·ä½“å‘½ä»¤ç›®å½•ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†ã€‚

```shell
mkdir src/commands // å‘½ä»¤å­˜æ”¾ç›®å½•
echo 'export function onCreate() { }' > src/commands/create.js // åˆ›å»º create å‘½ä»¤æ–‡ä»¶å¹¶å¯¼å‡ºå›è°ƒå‡½æ•°
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3cb8c7b0fc1e44feb5fe2ee0a661896b~tplv-k3u1fbpfcp-watermark.image?)


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3e02f989f1c4f388deb03bb0190649c~tplv-k3u1fbpfcp-watermark.image?)

### æµ‹è¯•è„šæœ¬å‘½ä»¤

æˆ‘ä»¬å¯ä»¥å…ˆåœ¨ `onCreate` é‡Œé¢æ‰“å°ä¸€ä¸‹æˆ‘ä»¬æ¥å—åˆ°çš„å‚æ•°ã€‚

```js
export function onCreate (cmd) {
  console.log(cmd)
}
```

æ‰§è¡Œä¸€ä¸‹è„šæœ¬ã€‚

```shell
node src/index.js
```

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc59305ae79e4e638c2f363aef6c7144~tplv-k3u1fbpfcp-watermark.image?)

æŠ¥é”™äº†ï¼ï¼ï¼æˆ‘ä»¬æ‰åˆšå¼€å§‹å°±æŠ¥é”™äº†ï¼Œæ˜¯å¦å·²ç»å¼€å§‹å´©æºƒï¼Ÿ

ç¨³ä½åˆ«æ…Œï¼Œä¸€åˆ‡åœ¨æˆ‘ä»¬çš„æ„æ–™ä¹‹ä¸­ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç¼–å†™çš„æ˜¯ `node` ç¨‹åºï¼Œæœ¬åº”è¯¥ä½¿ç”¨ `commonjs` ç®€ç§° `CJS` æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯ç”¨ `require` å’Œ `exports` ç­‰è¯­æ³•æ‰èƒ½æ­£å¸¸ä½¿ç”¨ `node xxx.js` è¿›è¡Œå¯åŠ¨ï¼Œä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨äº†æ–°ä¸€ä»£çš„ `esmodule` ç®€ç§° `ESM` æ ¼å¼ï¼Œæ‰€ä»¥ `node` è„¸ç›²äº†ï¼é‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å‘¢ï¼Ÿ

è§£å†³åŠæ³•ä¸€ï¼šå°† `.js` æ”¹æˆ `.mjs` ã€‚why? å¾ˆæ˜æ˜¾å› ä¸º `ESM` å’Œ CJS çš„åŠ è½½æ–¹å¼ä¸åŒï¼Œä¸ºäº†æ›´å¥½åŒºåˆ†è¿™ä¸¤ç§ä¸åŒçš„åŠ è½½æ–¹å¼ï¼Œæ‰€ä»¥åˆ›å»ºäº† `.mjs` çš„æ–‡ä»¶ç±»å‹ï¼Œæ—¨åœ¨ `Module javascript`ã€‚`.mjs` å°±æ˜¯è¡¨ç¤ºå½“å‰æ–‡ä»¶ç”¨ `ESM` çš„æ–¹å¼è¿›è¡ŒåŠ è½½ï¼Œå¦‚æœæ˜¯æ™®é€šçš„ `.js` æ–‡ä»¶ï¼Œåˆ™é‡‡ç”¨ `CJS` çš„æ–¹å¼åŠ è½½ã€‚

è§£å†³åŠæ³•äºŒï¼šé€šè¿‡ä¸€äº›æ¨¡å—æ‰“åŒ…å™¨è¿›è¡Œè½¬æ¢ä¸º `node` ç†Ÿæ‚‰çš„ `cjs` æ ¼å¼ï¼Œç„¶åå†è¿›è¡Œå¼€å‘ã€‚

è¿™é‡Œé€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼ŒåŸå› æ˜¯é‡‡ç”¨æ‰“åŒ…å™¨æˆ‘ä»¬å¯ä»¥å¯¹ä»£ç è¿›è¡Œå…¶ä»–æ“ä½œï¼Œä¾‹å¦‚ï¼šå‹ç¼©ã€è½¬æ¢ç­‰ã€‚

æ¨¡å—æ‰“åŒ…å™¨çš„è¯è¿™é‡Œé‡‡ç”¨ `esbuild` ï¼Œç†ç”±å°±æ˜¯ï¼šå¿«æ·ã€æ–¹ä¾¿ã€‚

```shell
npm i -D esbuild
// or
yarn add -D esbuild
```

å®‰è£…å¥½åå…ˆçœ‹ä¸‹å‘½ä»¤è¡Œå¸®åŠ©æ–‡æ¡£ã€‚

```shell
npx esbuild -h
// or
yarn esbuild -h
```

æ‰§è¡Œå®Œåä¼šçœ‹åˆ°ä»¥ä¸‹å¸®åŠ©ä¿¡æ¯ã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e56f4e6744e644719afd5d129abdb17b~tplv-k3u1fbpfcp-watermark.image?)

çœ‹è¿‡å¸®åŠ©ä¿¡æ¯åæˆ‘ä»¬åŠ å…¥å¦‚ä¸‹å‘½ä»¤ï¼š

```js
{
    // --bundle æ ‡è¯†æ‰“åŒ…çš„å…¥å£æ–‡ä»¶
    // --format è½¬æ¢ä¸ºç›®æ ‡æ ¼å¼ä»£ç 
    // --platform ç›®æ ‡å¹³å°ï¼Œé»˜è®¤ browser
    // --outdir è¾“å‡ºç›®å½•
    // å¼€å‘æ—¶å®æ—¶ç¼–è¯‘
    "dev": "esbuild --bundle ./src/index.js --format=cjs --platform=node --outdir=./lib --watch",
    // æ‰“åŒ…å‘½ä»¤
    "build": "esbuild --bundle ./src/index.js --format=cjs --platform=node --outdir=./lib",
    // æ‰§è¡Œ create å‘½ä»¤ï¼Œå¦‚æœæœ‰å¤šä¸ªå‘½ä»¤ï¼Œå¯ä»¥å»æ‰ create ï¼Œä½¿ç”¨æ—¶å†ä¼ å…¥
    "cli": "node ./lib/index.js create"
}
```

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e4773585bca143498bed754dd4befa9e~tplv-k3u1fbpfcp-watermark.image?)

æ‰§è¡Œä¸‹ `dev` å‘½ä»¤ï¼Œç„¶åé‡æ–°å¼€ä¸€ä¸ª `shell` å†æ‰§è¡Œ `cli` å‘½ä»¤ã€‚

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7cd9b391b1641689ec6f18f8ebe9335~tplv-k3u1fbpfcp-watermark.image?)

```shell
yarn cli
// or
npm run cli
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62651e3132504cf1a56be0410ad4ecf3~tplv-k3u1fbpfcp-watermark.image?)

è¾“å‡ºäº†ä¸€ä¸ª `{}` ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰“å°çš„ `cmd` å…¥å‚ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å¡«å…¥ä»»ä½•å‚æ•°ï¼Œæ‰€ä»¥è§£æåæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæ¥ä¸‹æ¥ä¼ å…¥ `type` å‚æ•°å†çœ‹çœ‹ã€‚

```shell
yarn cli -t component // -t æ˜¯ --type çš„åˆ«å
// or
npm run cli -- -t component // -- æ˜¯ npm run è„šæœ¬ä¼ å‚æ—¶éœ€è¦åŠ çš„ï¼Œç±»ä¼¼äºå‚æ•°é€ä¼ ç»™è„šæœ¬
```

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6889f4f665f42c3a2a93d6eb9ad7388~tplv-k3u1fbpfcp-watermark.image?)

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cf584b4258064ceea5056afb8aba2168~tplv-k3u1fbpfcp-watermark.image?)

ç°åœ¨å·²ç»èƒ½å¤Ÿæ­£å¸¸è·å–åˆ°å‘½ä»¤å‚æ•°äº†ï¼Œè¯æ˜å‘½ä»¤æ³¨å†ŒæˆåŠŸï¼Œåé¢å¯ä»¥ç»§ç»­å®ç°æˆ‘ä»¬çš„äº¤äº’é€»è¾‘ã€‚

### å®Œå–„ create å‘½ä»¤

æ¥ä¸‹æ¥å°±æ˜¯è¿›ä¸€æ­¥å®Œå–„æˆ‘ä»¬çš„å‘½ä»¤äº¤äº’äº†ï¼Œä»¥ `component` ä¸ºä¾‹ï¼Œä»£ç å¦‚ä¸‹ï¼š

```js
import inquirer from 'inquirer'
import { red } from 'kolorist'

// create type æ”¯æŒé¡¹
const CREATE_TYPES = ['component', 'lib-entry']
// æ–‡æ¡£åˆ†ç±»
const DOCS_CATEGORIES = ['é€šç”¨', 'å¯¼èˆª', 'åé¦ˆ', 'æ•°æ®å½•å…¥', 'æ•°æ®å±•ç¤º', 'å¸ƒå±€']

export async function onCreate(cmd = {}) {
  let { type } = cmd

  // å¦‚æœæ²¡æœ‰åœ¨å‘½ä»¤å‚æ•°é‡Œå¸¦å…¥ type é‚£ä¹ˆå°±è¯¢é—®ä¸€æ¬¡
  if (!type) {
    const result = await inquirer.prompt([
      {
        // ç”¨äºè·å–åçš„å±æ€§å
        name: 'type',
        // äº¤äº’æ–¹å¼ä¸ºåˆ—è¡¨å•é€‰
        type: 'list',
        // æç¤ºä¿¡æ¯
        message: 'ï¼ˆå¿…å¡«ï¼‰è¯·é€‰æ‹©åˆ›å»ºç±»å‹ï¼š',
        // é€‰é¡¹åˆ—è¡¨
        choices: CREATE_TYPES,
        // é»˜è®¤å€¼ï¼Œè¿™é‡Œæ˜¯ç´¢å¼•ä¸‹æ ‡
        default: 0
      }
    ])
    // èµ‹å€¼ type
    type = result.type
  }

  // å¦‚æœè·å–çš„ç±»å‹ä¸åœ¨æˆ‘ä»¬æ”¯æŒèŒƒå›´å†…ï¼Œé‚£ä¹ˆè¾“å‡ºé”™è¯¯æç¤ºå¹¶é‡æ–°é€‰æ‹©
  if (CREATE_TYPES.every((t) => type !== t)) {
    console.log(
      red(`å½“å‰ç±»å‹ä»…æ”¯æŒï¼š${CREATE_TYPES.join(', ')}ï¼Œæ”¶åˆ°ä¸åœ¨æ”¯æŒèŒƒå›´å†…çš„ "${type}"ï¼Œè¯·é‡æ–°é€‰æ‹©ï¼`)
    )
    return onCreate()
  }

  try {
    switch (type) {
      case 'component':
        // å¦‚æœæ˜¯ç»„ä»¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ”¶é›†ä¸€äº›ä¿¡æ¯
        const info = await inquirer.prompt([
          {
            name: 'name',
            type: 'input',
            message: 'ï¼ˆå¿…å¡«ï¼‰è¯·è¾“å…¥ç»„ä»¶ name ï¼Œå°†ç”¨ä½œç›®å½•åŠæ–‡ä»¶åï¼š',
            validate: (value) => {
              if (value.trim() === '') {
                return 'ç»„ä»¶ name æ˜¯å¿…å¡«é¡¹ï¼'
              }
              return true
            }
          },
          {
            name: 'title',
            type: 'input',
            message: 'ï¼ˆå¿…å¡«ï¼‰è¯·è¾“å…¥ç»„ä»¶ä¸­æ–‡åç§°ï¼Œå°†ç”¨ä½œæ–‡æ¡£åˆ—è¡¨æ˜¾ç¤ºï¼š',
            validate: (value) => {
              if (value.trim() === '') {
                return 'ç»„ä»¶åç§°æ˜¯å¿…å¡«é¡¹ï¼'
              }
              return true
            }
          },
          {
            name: 'category',
            type: 'list',
            message: 'ï¼ˆå¿…å¡«ï¼‰è¯·é€‰æ‹©ç»„ä»¶åˆ†ç±»ï¼Œå°†ç”¨ä½œæ–‡æ¡£åˆ—è¡¨åˆ†ç±»ï¼š',
            choices: DOCS_CATEGORIES,
            default: 0
          }
        ])

        createComponent(info)
        break
      case 'lib-entry':
        createLibEntry()
        break
      default:
        break
    }
  } catch (e) {
    console.log(red('âœ–') + e.toString())
    process.exit(1)
  }
}

function createComponent(info) {
  // è¾“å‡ºæ”¶é›†åˆ°çš„ç»„ä»¶ä¿¡æ¯
  console.log(info)
}

function createLibEntry() {
  console.log('create lib-entry file.')
}
```

okï¼Œæ¥ä¸‹æ¥å°è¯•è¿è¡Œä¸€ä¸‹æˆ‘ä»¬çš„è„šæœ¬ã€‚

å…ˆå°è¯•é”™è¯¯çš„ç±»å‹ï¼š

```shell
yarn cli -t error
// or
npm run cli -- -t error
```

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/381660784c474a28b19a98b4a5fe0626~tplv-k3u1fbpfcp-watermark.image?)

æŒ‰ç…§æˆ‘ä»¬çš„é¢„æƒ³æç¤ºäº†é”™è¯¯ä¿¡æ¯å¹¶è®©æˆ‘ä»¬é‡æ–°é€‰æ‹©ç±»å‹ã€‚

æ¥ä¸‹æ¥å°è¯•æ­£ç¡®çš„ç±»å‹ï¼š

```shell
yarn cli -t component
// or
npm run cli -- -t component
```

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3044548a7c79467eb34e71f385a63be3~tplv-k3u1fbpfcp-watermark.image?)

å› ä¸ºæŒ‡å®šäº†ç±»å‹ä¸ºç»„ä»¶ï¼Œæ‰€ä»¥ç°åœ¨éœ€è¦æ”¶é›†ä¸€ä¸‹å³å°†åˆ›å»ºçš„ç»„ä»¶ä¿¡æ¯ã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5908508caddb40359d654595c48aef85~tplv-k3u1fbpfcp-watermark.image?)

æŒ‰ç…§æç¤ºä¿¡æ¯ä¸€æ­¥ä¸€æ­¥å®Œæˆè¾“å…¥æœ€ç»ˆè·å–åˆ°äº†æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ¨¡æ¿çš„ç”Ÿæˆäº†ã€‚

## æœªå®Œå¾…ç»­

å°½æƒ…æœŸå¾…åç»­æ›´ç²¾å½©çš„åˆ†äº«ï¼



<EditInfo time="2021å¹´10æœˆ22æ—¥ 23:41" title="é˜…è¯» 2012 Â·  ç‚¹èµ 22 Â·  è¯„è®º 10 Â·  æ”¶è— 13" />
